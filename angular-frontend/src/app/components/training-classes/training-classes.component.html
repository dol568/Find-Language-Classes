<div class="mt-5">
  <div class="pt-5 container">
    <div class="row">
      <section class="col-8">
        <ng-container *ngIf="(trainingClasses$ | async) as trainingClasses">
          <div *ngIf="trainingClasses.length === 0"
            class="d-flex  align-items-center pt-5 pb-2 flex-column"
            style="font-size: 18px"
          >O classes found.
          </div>
          <div class="d-flex justify-content-between align-items-center pb-2 flex-column"
               *ngIf="trainingClasses.length > 0">
            <div class="mb-4  w-100" *ngFor="let item of trainingClasses;  index as i">
              <button
                *ngIf="isButtonVisible(formatTime(item.time))
                && ( i === 0 || formatTime(item.time) !== formatTime(trainingClasses[i - 1].time))"
                class="btn btn-primary mb-2"
                style="width: 80px"
              >{{ formatTime(item.time) }}
              </button>
              <div class="card shadow-lg mx-0">
                <div class="row ">
                  <div class="col-2">
                    <img
                      class="card-img-top rounded-circle mt-3 ml-3"
                      [src]="item.hostImage | authenticate"
                      handleImageError
                      alt="Card image cap"
                      style="width: 100%"
                    >
                  </div>
                  <div class="col-10">
                    <div class="card-body">
                      <h5 class="card-title">{{ item.title }}</h5>
                      <p class="card-text">Hosted by <a style="cursor: pointer; color: #48b0f7"
                                                        (click)="goToProfile(item.hostUserName)">{{ item.hostName }}</a>
                      </p>
                      <button type="button" class="btn btn-outline-danger" *ngIf="item.isHost">
                        You are hosting this Class
                      </button>
                      <button type="button" class="btn btn-outline-success" *ngIf="item.isGoing">
                        You are going to this Class
                      </button>
                      <button
                        (click)="joinClass(item.id)"
                        type="button"
                        class="btn btn-outline-primary"
                        *ngIf="!item.isGoing && !item.isHost && (item.totalSpots - item.userTrainingClasses.length) > 0"
                      >Click here to join
                      </button>
                      <button
                        type="button"
                        class="btn btn-outline-dark"
                        *ngIf="!item.isGoing && !item.isHost && (item.totalSpots - item.userTrainingClasses.length) === 0"
                      >This class is full
                      </button>
                    </div>
                  </div>
                </div>
                <div class="card-body border-top border-bottom py-3">
                  <i class="fas fa-clock"></i>
                  Every {{getDaysOfWeekWords(item.dayOfWeek)}} at {{item.time}}
                  <i class="fas fa-map-marker ml-3"></i>  {{item.address}} {{item.city}}
                  , {{item.country}} {{item.postalCode}}
                </div>
                <div class="card-body py-2 mx-2">
                  <div class="row">
                    <div class="col-lg-1 col-md-1 col-xs-1 thumb px-1" *ngFor="let user of item.userTrainingClasses">
                      <img
                        class="rounded-circle resize-image"
                        [src]="user.image | authenticate"
                        handleImageError
                        alt="Card image cap"
                        (click)="goToProfile(user.userName)"
                        data-toggle="tooltip"
                        data-placement="top"
                        [title]='user.fullName'
                        style="width: 100%; cursor:pointer;"
                      >
                    </div>
                  </div>
                </div>
                <div class="card-body d-flex justify-content-between align-items-center border-top">
                  {{ (item.description).length > 50 ? (item.description).slice(0, 50) + '...' : item.description }}
                  <div class="d-flex">
                    <button
                      type="button"
                      class="btn btn-info mr-2"
                      *ngIf="item.isGoing"
                      (click)="abandonClass(item.id)"
                    >Leave this Class
                    </button>
                    <button type="button" class="btn btn-danger mr-2" (click)="deleteTrainingClass(+item.id)">Delete
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary"
                      [routerLink]="'/' + _client_training_classes + '/' + item.id"
                    >View
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </section>
      <section class="col-4 pt-5">
        <div class="card shadow-lg mb-4">
          <ul class="list-group">
            <li class="list-group-item" style='font-size:16px; color: #0cabba'>
              <i class="fas fa-filter mr-3" style='font-size:24px;'>
              </i><strong>Filters</strong></li>
            <li class="list-group-item active"
                [class.active]="null === this._classesParams.attend"
                (click)="filterAttendance(null)">All Classes
            </li>
            <li class="list-group-item "
                [class.active]="AttendanceType.GOING === this._classesParams.attend"
                (click)="filterAttendance(AttendanceType.GOING)">I'm Going
            </li>
            <li class="list-group-item "
                [class.active]="AttendanceType.HOST === this._classesParams.attend"
                (click)="filterAttendance(AttendanceType.HOST)">I'm Hosting
            </li>
          </ul>
        </div>
        <div class="card shadow-lg">
          <ul class="list-group">
            <li class="list-group-item" style='font-size:16px; color: #0cabba'>
              <i class="fas fa-calendar mr-3" style='font-size:24px;'>
              </i><strong>Select Day & Time</strong></li>
            <li class="list-group-item bg-light">
              <form [formGroup]="timeForm" (ngSubmit)="submitFunc()">
                <div class="form-group">
                  <label for="time"><strong>Time</strong></label>
                  <input
                    id="time"
                    placeholder="--:--"
                    [ngxTimepicker]="picker" min="9:00" max="21:00"
                    [format]="24"
                    class="form-control"
                    formControlName="time"
                  />
                  <ngx-material-timepicker #picker>
                  </ngx-material-timepicker>
                  <div class="form-group">
                    <button
                      type="submit"
                      class="btn btn-success btn-block mt-3"
                      [disabled]="!timeForm.valid"
                    >Search
                    </button>
                  </div>
                </div>
              </form>
            </li>
          </ul>
        </div>
      </section>
    </div>
  </div>
</div>
