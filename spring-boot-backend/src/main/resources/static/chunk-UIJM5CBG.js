import{K as c,Lb as R,N as H,Nb as A,R as P,Tb as F,Xb as L,a as k,ac as N,b as C,d as t,e as h,f as a,g as v,hc as x,q as U,tb as y,wa as I}from"./chunk-AF63XHS6.js";var T={production:!0,apiUrl:"/api/"};var $=T.apiUrl,G="languageClasses",B="users",D="login",K="register";var st=(()=>{var r,S,w,u,_,f,o,l,d,m,n,b,j;let g=class g{constructor(){h(this,b);h(this,r,void 0);h(this,S,void 0);h(this,w,void 0);h(this,u,void 0);h(this,_,void 0);h(this,f,void 0);h(this,o,void 0);h(this,l,void 0);h(this,d,void 0);h(this,m,void 0);h(this,n,void 0);a(this,r,P(A)),a(this,S,P(F)),a(this,w,P(L)),a(this,u,$),a(this,_,t(this,u)+"follow"),a(this,f,t(this,u)+"profiles"),a(this,o,I(null)),a(this,l,I(void 0)),a(this,d,I(void 0)),a(this,m,I(void 0)),a(this,n,I(!1)),this.currentUser=y(t(this,o)),this.profile=y(t(this,l)),this.photo=y(t(this,d)),this.loggedInUserPhoto=y(t(this,m))}loadCurrentUser(){let s=sessionStorage.getItem(x);if(s===null)return t(this,o).set(null),t(this,n).set(!1),null;let e=new R;return e=e.set("Authorization",`Bearer ${s}`),t(this,r).get(t(this,u)+B,{headers:e}).pipe(U(i=>{let p=i.data;p?(sessionStorage.setItem(x,p.token),t(this,o).set(p),v(this,b,j).call(this,p?.photoUrl).subscribe(O=>{t(this,m).set(O)}),t(this,n).set(!0)):(t(this,n).set(!1),t(this,o).set(null))}))}isAuthenticatedUser(){return t(this,n).call(this)}login(s){return t(this,r).post(t(this,u)+D,s).pipe(c(e=>{let i=e.data;i&&(sessionStorage.setItem(x,i.token),t(this,o).set(i),t(this,n).set(!0))}))}register(s){return t(this,r).post(t(this,u)+K,s).pipe(c(e=>{let i=e.data;i&&(sessionStorage.setItem(x,i.token),t(this,o).set(i),t(this,n).set(!0))}))}logout(){sessionStorage.removeItem(x),t(this,o).set(null),t(this,n).set(!1),t(this,w).navigate([N])}profile$(s){return t(this,r).get(t(this,f)+"/"+s).pipe(c(e=>{v(this,b,j).call(this,e.data.photoUrl).subscribe(i=>{t(this,d).set(i)}),t(this,l).set(e.data)}))}updateProfile(s,e){return t(this,r).put(t(this,f)+"/"+s,e).pipe(U(i=>i.data),c(i=>{t(this,o).update(p=>C(k({},p),{fullName:i.fullName})),t(this,l).set(i)}))}uploadPhoto(s){return t(this,r).put(t(this,f)+"/photo",s).pipe(U(e=>e.data),c(e=>{let i=k({},this.currentUser());i.photoUrl=e,v(this,b,j).call(this,e).subscribe(p=>{t(this,d).set(p),t(this,m).set(p)}),t(this,o).set(i),t(this,l).update(p=>C(k({},p),{photoUrl:e}))}))}followUser(s){return t(this,r).post(t(this,_)+"/"+s,null).pipe(U(e=>e.data),c(e=>{t(this,l).set(e)}))}unFollowUser(s){return t(this,r).delete(t(this,_)+"/"+s).pipe(U(e=>e.data),c(e=>{t(this,l).set(e)}))}};r=new WeakMap,S=new WeakMap,w=new WeakMap,u=new WeakMap,_=new WeakMap,f=new WeakMap,o=new WeakMap,l=new WeakMap,d=new WeakMap,m=new WeakMap,n=new WeakMap,b=new WeakSet,j=function(s){return t(this,r).get(s,{responseType:"blob"}).pipe(U(e=>t(this,S).bypassSecurityTrustUrl(URL.createObjectURL(e))))},g.\u0275fac=function(e){return new(e||g)},g.\u0275prov=H({token:g,factory:g.\u0275fac,providedIn:"root"});let z=g;return z})();export{$ as a,G as b,st as c};
