import{a as j,c as k,d as x,e as I}from"./chunk-RXYRJRZD.js";import{a as d}from"./chunk-KLBPFCVD.js";import{Cb as S,Db as g,N as b,Nb as U,R as p,d as n,e as l,f as c,k as f,l as m,q as a}from"./chunk-5EEGSPK3.js";var O=(()=>{var r,o;let s=class s{constructor(){l(this,r,void 0);l(this,o,void 0);c(this,r,p(g)),c(this,o,p(U)),this.baseUrl=j,this.currentUserSource=new m(null),this.currentUser$=this.currentUserSource.asObservable(),this.refreshSubject=new f,this.refresh$=this.refreshSubject.asObservable()}triggerRefresh(){this.refreshSubject.next()}loadCurrentUser(i){if(i===null)return this.currentUserSource.next(null),null;let e=new S;return e=e.set("Authorization",`Bearer ${i}`),n(this,r).get(this.baseUrl+k,{headers:e}).pipe(a(t=>{let u=t.data;return u?(sessionStorage.setItem("token",u.token),this.currentUserSource.next(u),u):null}))}login(i){return n(this,r).post(this.baseUrl+x,i).pipe(a(e=>{let t=e.data;t&&(sessionStorage.setItem("token",t.token),this.currentUserSource.next(t))}))}register(i){return n(this,r).post(this.baseUrl+I,i).pipe(a(e=>{let t=e.data;t&&(sessionStorage.setItem("token",t.token),this.currentUserSource.next(t))}))}logout(){sessionStorage.removeItem("token"),this.currentUserSource.next(null),n(this,o).navigate([d])}};r=new WeakMap,o=new WeakMap,s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=b({token:s,factory:s.\u0275fac,providedIn:"root"});let h=s;return h})();export{O as a};
